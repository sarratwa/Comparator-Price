for i in range(1,2):
    Site = requests.get('https://www.cosmeto.tn/shop/page/{}/'.format(i)).text
    soup = BeautifulSoup(Site, 'html.parser')
    ProductList = soup.find_all("ul",{"class":"products columns-6 hongo-shop-standard hongo-shop-common-isotope hongo-product-list-common-wrap hongo-shop-col-6 hongo-shop-md-col-4 hongo-shop-sm-col-4 hongo-shop-xs-col-1 gutter-large hongo-buttons-1 hongo-text-center"})
    
print(ProductList)   
    for Product in ProductList:
        link = Product.find("a",{"class":"woocommerce-LoopProduct-link woocommerce-loop-product__link"}).get("href")
        ProductLinks.append(link)
#print(ProductLinks)


for link in ProductLinks:
    CosmoSite = requests.get(link,headers=headers).text
    soup2 = BeautifulSoup(CosmoSite, 'html.parser')
#Product_Name
    try:
        Prodcut_Name = soup2.find("h2",{"class":"woocommerce-loop-product__title"}).text
    except:
        Prodcut_Name = ("-")
#New_Price
    try:
        if soup2.find("del",{"aria-hidden":"true"}):
            New_Price = soup2.find("ins").text
        else: 
            New_Price = soup2.find("span",{"class":"woocommerce-Price-amount amount"}).text
    except:
        New_Price = ("-")
#Old_Price
    try:
        Old_Price = soup2.find("del",{"aria-hidden":"true"}).text
    except:
        Old_Price = ("-")
#Links
    try:
        Links = soup2.find("a",{"class":"woocommerce-LoopProduct-link woocommerce-loop-product__link"}).get('href')
    except:
        Links = ("-")
#Prod_Det
    try:
        Prod_det = soup2.find("div",{"class":"woocommerce-Tabs-panel woocommerce-Tabs-panel--description panel entry-content wc-tab"}).text
    except:
        Prod_det = ("-")
    Cos = {"Produit":Prodcut_Name, "Prix initiale":New_Price, "Ancien prix":Old_Price, "Description":Prod_det, "Lien":Links}
    Cosmeto.append(Cos)
    c += 1
    print ("Completed", c)

CosmetoAllProduct = pd.DataFrame(Cosmeto)

#To Excel
#CosmetoAllProduct.to_excel("Produit_Cosmeto.xlsx",index=False)